---
import { Image } from 'astro:assets';
import logo from '../assets/images/logo-negative.svg?url';

// Slide 1 Images
import sm1 from '../assets/images/welcome/header_small_01.jpg';
import md1 from '../assets/images/welcome/header_medium_01.jpg';
import lg1 from '../assets/images/welcome/header_large_01.jpg';

// Slide 2 Images
import sm2 from '../assets/images/welcome/header_small_02.jpg';
import md2 from '../assets/images/welcome/header_medium_02.jpg';
import lg2 from '../assets/images/welcome/header_large_02.jpg';

// Slide 3 Images
import sm3 from '../assets/images/welcome/header_small_03.jpg';
import md3 from '../assets/images/welcome/header_medium_03.jpg';
import lg3 from '../assets/images/welcome/header_large_03.jpg';

const slides = [
  { sm: sm1, md: md1, lg: lg1, id: 'slide-1' },
  { sm: sm2, md: md2, lg: lg2, id: 'slide-2' },
  { sm: sm3, md: md3, lg: lg3, id: 'slide-3' },
];
---

<div class="container" id="welcome">
  <div class="carousel">
    {slides.map((slide, index) => (
      <picture class:list={['slide', { active: index === 0 }]} data-index={index}>
        <source media="(min-width: 1200px)" srcset={slide.lg.src} />
        <source media="(min-width: 768px)" srcset={slide.md.src} />
        <img src={slide.sm.src} alt="" class="slide-img" />
      </picture>
    ))}
  </div>

  <div class="controls">
    {slides.map((_, index) => (
      <label class="radio-label">
        <input 
          type="radio" 
          name="welcome-slider" 
          value={index} 
          checked={index === 0} 
        />
        <span class="dot"></span>
      </label>
    ))}
  </div>

  <img id="welcome_logo" src={logo} alt="PollinAction Logo" />
</div>

<script>
  const radios = document.querySelectorAll('input[name="welcome-slider"]');
  const slides = document.querySelectorAll('.slide');

  radios.forEach((radio) => {
    radio.addEventListener('change', (e) => {
      const targetIndex = (e.target as HTMLInputElement).value;
      
      slides.forEach((slide, index) => {
        if (index === parseInt(targetIndex)) {
          slide.classList.add('active');
        } else {
          slide.classList.remove('active');
        }
      });
    });
  });
</script>

<style lang="scss">
  @use '../assets/style/main.scss' as vars;
  
  #welcome {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;   
    position: relative;
    overflow: hidden;
    background-color: vars.$color-purple;
    height: 340px;
  }

  .carousel {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  .slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    
    &.active {
      opacity: 1;
    }
  }

  .slide-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .controls {
    position: absolute;
    bottom: 20px;
    z-index: 2;
    display: flex;
    gap: 15px;
  }

  .radio-label {
    cursor: pointer;
    display: flex;
    align-items: center;
    
    input {
      display: none; // Hide actual radio button
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: vars.$color-gray;
      transition: all 0.3s ease;
    }

    input:checked + .dot {
      background-color: vars.$color-purple;
      border: 1px solid vars.$color-gray;
      transform: scale(1.2);
    }
  }

  #welcome_logo {
    width: 200px;
    height: auto;
    z-index: 1;
    margin-bottom: 20px; /* Make space for controls */
  }

  @media screen and (min-width: vars.$bp-medium) {
    #welcome_logo {
      width: 300px;
    }
  }
</style>